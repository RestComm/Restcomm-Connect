<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!--
  @author maria.farooq@telestax.com (Maria Farooq)
-->
<mapper namespace="org.mobicents.servlet.sip.restcomm.dao.MediaResourceBrokerDao">

  <insert id="addMediaResourceBrokerEntity" parameterType="map">
    INSERT INTO 
    	"media_resource_broker_entity" 
    		("conference_sid", "slave_ms_id", "slave_ms_bridge_ep_id", "slave_ms_cnf_ep_id", 
    		"is_bridged_together", "slave_ms_sdp") 
    	VALUES 
    		(#{conference_sid}, #{slave_ms_id}, #{slave_ms_bridge_ep_id}, #{slave_ms_cnf_ep_id}, 
    		#{is_bridged_together}, #{slave_ms_sdp});
  </insert>
  
  <select id="getMediaResourceBrokerEntities" resultType="hashmap">
    SELECT * FROM "media_resource_broker_entity";
  </select>
  
  <delete id="removeMediaResourceBrokerEntity" parameterType="map">
    DELETE FROM "media_resource_broker_entity" WHERE "conference_sid"=#{conference_sid} AND "slave_ms_id"=#{slave_ms_id};
  </delete>
  
  <update id="updateMediaResource" parameterType="map">
    UPDATE "media_resource_broker_entity" 
    	SET "slave_ms_bridge_ep_id"=#{slave_ms_bridge_ep_id}, 
    		"slave_ms_cnf_ep_id"=#{slave_ms_cnf_ep_id}, "is_bridged_together"=#{is_bridged_together}, 
    		"slave_ms_sdp"=#{slave_ms_sdp} 
    WHERE "conference_sid"=#{conference_sid} AND "slave_ms_id"=#{slave_ms_id};
  </update>

</mapper>