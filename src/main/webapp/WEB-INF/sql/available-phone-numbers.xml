<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!--
  @author thomas.quintana@telestax.com (Thomas Quintana)
-->
<mapper namespace="org.mobicents.servlet.sip.restcomm.dao.mybatis.AvailablePhoneNumberDao">
  <insert id="addAvailablePhoneNumber" parameterType="map">
    INSERT INTO available_phone_numbers (friendly_name, phone_number, lata, rate_center, latitude, longitude, region, postal_code, iso_country)
    VALUES (#{friendly_name}, #{phone_number}, #{lata}, #{rate_center}, #{latitude}, #{longitude}, #{region}, #{postal_code}, #{iso_country});
  </insert>
  
  <select id="getAvailablePhoneNumbers" resultType="hashmap">
    SELECT * FROM available_phone_numbers;
  </select>
  
  <select id="getAvailablePhoneNumbersByAreaCode" parameterType="string" resultType="hashmap">
    SELECT * FROM available_phone_numbers WHERE iso_country='US' OR iso_country='CA' AND phone_number LIKE #{phone_number};
  </select>
  
  <select id="getAvailablePhoneNumbersByPattern" parameterType="string" resultType="hashmap">
    SELECT * FROM available_phone_numbers WHERE phone_number LIKE #{phone_number};
  </select>
  
  <select id="getAvailablePhoneNumbersByRegion" parameterType="string" resultType="hashmap">
    SELECT * FROM available_phone_numbers WHERE region=#{region};
  </select>
  
  <select id="getAvailablePhoneNumbersByPostalCode" parameterType="int" resultType="hashmap">
    SELECT * FROM available_phone_numbers WHERE postal_code=#{postal_code};
  </select>
  
  <delete id="removeAvailablePhoneNumber" parameterType="string">
    DELETE FROM available_phone_numbers WHERE phone_number=#{phone_number};
  </delete>
</mapper>